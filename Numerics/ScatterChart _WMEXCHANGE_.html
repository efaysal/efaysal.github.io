<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="../build/nv.d3.js"></script>

    <style>
        text {
            font: 12px sans-serif;
        }
        svg {
            display: block;
        }
        html, body, #test1, svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="test1" class='with-3d-shadow with-transitions'>
    <svg></svg>
</div>

<script>

var datax=[{"Name":"AMS","AMEAN":-0.014,"GMEAN":-0.0217,"PERFORMANCE":29.3599,"STOCKN":65,"_row":"AMS"},{"Name":"ASE","AMEAN":-0.021,"GMEAN":-0.0112,"PERFORMANCE":28.9147,"STOCKN":347,"_row":"ASE"},{"Name":"ASX","AMEAN":-0.0028,"GMEAN":-0.0077,"PERFORMANCE":30.2392,"STOCKN":979,"_row":"ASX"},{"Name":"ATH","AMEAN":-0.0196,"GMEAN":-0.0267,"PERFORMANCE":28.9513,"STOCKN":54,"_row":"ATH"},{"Name":"BER","AMEAN":-0.0108,"GMEAN":-0.0169,"PERFORMANCE":27.7927,"STOCKN":354,"_row":"BER"},{"Name":"BRU","AMEAN":0.0006,"GMEAN":-0.0031,"PERFORMANCE":31.8833,"STOCKN":71,"_row":"BRU"},{"Name":"BSE","AMEAN":-0.0008,"GMEAN":-0.0049,"PERFORMANCE":28.0458,"STOCKN":498,"_row":"BSE"},{"Name":"BUE","AMEAN":-0.0012,"GMEAN":-0.0106,"PERFORMANCE":34.326,"STOCKN":44,"_row":"BUE"},{"Name":"CPH","AMEAN":-0.0194,"GMEAN":-0.0145,"PERFORMANCE":25.6283,"STOCKN":83,"_row":"CPH"},{"Name":"DOH","AMEAN":-0.0329,"GMEAN":-0.0353,"PERFORMANCE":27.9492,"STOCKN":43,"_row":"DOH"},{"Name":"DUS","AMEAN":-0.0176,"GMEAN":-0.0046,"PERFORMANCE":26.1826,"STOCKN":119,"_row":"DUS"},{"Name":"EBS","AMEAN":-0.0229,"GMEAN":-0.0034,"PERFORMANCE":28.5932,"STOCKN":159,"_row":"EBS"},{"Name":"FRA","AMEAN":-0.0123,"GMEAN":-0.0194,"PERFORMANCE":28.0144,"STOCKN":1312,"_row":"FRA"},{"Name":"GER","AMEAN":-0.0159,"GMEAN":-0.0147,"PERFORMANCE":29.6054,"STOCKN":490,"_row":"GER"},{"Name":"HAM","AMEAN":-0.0153,"GMEAN":-0.009,"PERFORMANCE":25.7269,"STOCKN":81,"_row":"HAM"},{"Name":"HAN","AMEAN":-0.0155,"GMEAN":-0.0175,"PERFORMANCE":27.5974,"STOCKN":26,"_row":"HAN"},{"Name":"HEL","AMEAN":-0.0061,"GMEAN":-0.0067,"PERFORMANCE":30.3761,"STOCKN":61,"_row":"HEL"},{"Name":"HKG","AMEAN":-0.0179,"GMEAN":-0.0232,"PERFORMANCE":28.6369,"STOCKN":821,"_row":"HKG"},{"Name":"IOB","AMEAN":-0.0209,"GMEAN":-0.0264,"PERFORMANCE":31.6592,"STOCKN":28,"_row":"IOB"},{"Name":"IST","AMEAN":0.0052,"GMEAN":0.0007,"PERFORMANCE":35.1983,"STOCKN":226,"_row":"IST"},{"Name":"JKT","AMEAN":0.0039,"GMEAN":-0.0015,"PERFORMANCE":33.8395,"STOCKN":225,"_row":"JKT"},{"Name":"KLS","AMEAN":-0.0014,"GMEAN":-0.0056,"PERFORMANCE":31.3567,"STOCKN":186,"_row":"KLS"},{"Name":"KSC","AMEAN":-0.0121,"GMEAN":-0.0098,"PERFORMANCE":27.1901,"STOCKN":294,"_row":"KSC"},{"Name":"LSE","AMEAN":-0.0121,"GMEAN":-0.0229,"PERFORMANCE":28.6408,"STOCKN":1274,"_row":"LSE"},{"Name":"MCE","AMEAN":-0.0214,"GMEAN":-0.0263,"PERFORMANCE":28.769,"STOCKN":67,"_row":"MCE"},{"Name":"MCX","AMEAN":0.0058,"GMEAN":0.0081,"PERFORMANCE":27.5232,"STOCKN":82,"_row":"MCX"},{"Name":"MEX","AMEAN":0.0014,"GMEAN":0.0007,"PERFORMANCE":30.6516,"STOCKN":228,"_row":"MEX"},{"Name":"MIL","AMEAN":-0.0224,"GMEAN":-0.0326,"PERFORMANCE":24.7121,"STOCKN":121,"_row":"MIL"},{"Name":"MUN","AMEAN":-0.0162,"GMEAN":-0.0113,"PERFORMANCE":25.6033,"STOCKN":328,"_row":"MUN"},{"Name":"NCM","AMEAN":-0.0178,"GMEAN":-0.0299,"PERFORMANCE":26.9801,"STOCKN":706,"_row":"NCM"},{"Name":"NGM","AMEAN":-0.0249,"GMEAN":-0.0307,"PERFORMANCE":25.1827,"STOCKN":468,"_row":"NGM"},{"Name":"NMS","AMEAN":-0.0184,"GMEAN":-0.0246,"PERFORMANCE":28.6826,"STOCKN":1579,"_row":"NMS"},{"Name":"NSI","AMEAN":0.0031,"GMEAN":-0.0081,"PERFORMANCE":30.0062,"STOCKN":278,"_row":"NSI"},{"Name":"NYQ","AMEAN":-0.0069,"GMEAN":-0.0204,"PERFORMANCE":33.7157,"STOCKN":2770,"_row":"NYQ"},{"Name":"NZE","AMEAN":0.0058,"GMEAN":0.0043,"PERFORMANCE":35.7084,"STOCKN":90,"_row":"NZE"},{"Name":"OBB","AMEAN":-0.0052,"GMEAN":-0.0491,"PERFORMANCE":29.1466,"STOCKN":302,"_row":"OBB"},{"Name":"OSL","AMEAN":-0.0089,"GMEAN":-0.0135,"PERFORMANCE":31.2517,"STOCKN":140,"_row":"OSL"},{"Name":"PAR","AMEAN":-0.0024,"GMEAN":-0.0133,"PERFORMANCE":32.3184,"STOCKN":334,"_row":"PAR"},{"Name":"PCX","AMEAN":-0.0224,"GMEAN":-0.0279,"PERFORMANCE":31.6431,"STOCKN":21,"_row":"PCX"},{"Name":"PNK","AMEAN":-0.0074,"GMEAN":-0.0206,"PERFORMANCE":30.7671,"STOCKN":5146,"_row":"PNK"},{"Name":"SAO","AMEAN":0.0546,"GMEAN":0.0018,"PERFORMANCE":83.3256,"STOCKN":198,"_row":"SAO"},{"Name":"SES","AMEAN":-0.0013,"GMEAN":-0.0119,"PERFORMANCE":31.3585,"STOCKN":311,"_row":"SES"},{"Name":"SET","AMEAN":-0.0025,"GMEAN":-0.0077,"PERFORMANCE":31.3393,"STOCKN":107,"_row":"SET"},{"Name":"STO","AMEAN":-0.0186,"GMEAN":-0.0166,"PERFORMANCE":26.4063,"STOCKN":148,"_row":"STO"},{"Name":"STU","AMEAN":-0.0131,"GMEAN":-0.018,"PERFORMANCE":29.7616,"STOCKN":467,"_row":"STU"},{"Name":"TAI","AMEAN":-0.0134,"GMEAN":-0.0064,"PERFORMANCE":30.0274,"STOCKN":248,"_row":"TAI"},{"Name":"TLV","AMEAN":-0.0101,"GMEAN":-0.0067,"PERFORMANCE":29.1929,"STOCKN":80,"_row":"TLV"},{"Name":"TOR","AMEAN":-0.0088,"GMEAN":-0.0075,"PERFORMANCE":31.2764,"STOCKN":894,"_row":"TOR"},{"Name":"TWO","AMEAN":-0.0039,"GMEAN":-0.0048,"PERFORMANCE":33.1626,"STOCKN":147,"_row":"TWO"},{"Name":"VAN","AMEAN":0.0004,"GMEAN":0.0054,"PERFORMANCE":35.8416,"STOCKN":843,"_row":"VAN"},{"Name":"VIE","AMEAN":-0.0074,"GMEAN":-0.0145,"PERFORMANCE":29.1403,"STOCKN":30,"_row":"VIE"},{"Name":"VTX","AMEAN":-0.0029,"GMEAN":-0.0089,"PERFORMANCE":32.3125,"STOCKN":17,"_row":"VTX"}];


var PERIOD= [{"PERIOD":"Period {2015-11-30} : {2016-04-15}"}];


    // register our custom symbols to nvd3
    // make sure your path is valid given any size because size scales if the chart scales.
    nv.utils.symbolMap.set('thin-x', function(size) {
        size = Math.sqrt(size);
        return 'M' + (-size/2) + ',' + (-size/2) +'l' + size + ',' + size +'m0,' + -(size) +'l' + (-size) + ',' + size;
    });

    // create the chart
    var chart;
    nv.addGraph(function() {
        chart = nv.models.scatterChart()
            .showDistX(true)
            .showDistY(true)
            .useVoronoi(true)
            .color(d3.scale.category10().range())
            .duration(300)
            .showLegend(false)
        ;

        chart.yAxis
    .axisLabel('Performance');
    chart.xAxis
    .axisLabel('Arth_Mean');
    
       chart.dispatch.on('renderEnd', function(){
           console.log('render complete');
        });

        chart.xAxis.tickFormat(d3.format('.02f'));
        chart.yAxis.tickFormat(d3.format('.02f'));
       chart.tooltipContent(function(key) {
       // return '<h2>' + key + '</h2>';
       return key;
       });

        d3.select('#test1 svg')
            .datum(randomData(datax.length))
            .call(chart);

        nv.utils.windowResize(chart.update);

        chart.dispatch.on('stateChange', function(e) { ('New State:', JSON.stringify(e)); });
        return chart;
    });

    function randomData(points) { //# groups,# points per group
        // smiley and thin-x are our custom symbols!
        var data = [];
        var shapes = ['square'];
        var     random = d3.random.normal();

        for (i = 0; i < points; i++) {
            data.push({ key:'<h2>' +  datax[i].Name + '</h2>' + '<p><small> ' + ' # of Stocks ' + datax[i].STOCKN + ' </small> </p>'+ '<p><small>' + PERIOD[0].PERIOD + ' </small> </p>',values: []});
            data[i].values.push({x: datax[i].AMEAN,y: datax[i].PERFORMANCE,size: Math.round(datax[i].PERFORMANCE * 100) ,shape: shapes[0 % shapes.length]});
        }

        return data;
    }


</script>
</body>
</html>
