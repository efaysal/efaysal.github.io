<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="../build/nv.d3.js"></script>

    <style>
        text {
            font: 12px sans-serif;
        }
        svg {
            display: block;
        }
        html, body, #test1, svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="test1" class='with-3d-shadow with-transitions'>
    <svg></svg>
</div>

<script>

var datax= [{"Name":"AMS","AMEAN":-0.0066,"GMEAN":-0.0112,"PERFORMANCE":27.6557,"_row":"AMS"},{"Name":"ASE","AMEAN":-0.0146,"GMEAN":-0.0077,"PERFORMANCE":27.5593,"_row":"ASE"},{"Name":"ASX","AMEAN":0.0015,"GMEAN":-0.0025,"PERFORMANCE":27.3937,"_row":"ASX"},{"Name":"ATH","AMEAN":-0.0054,"GMEAN":-0.0103,"PERFORMANCE":26.9875,"_row":"ATH"},{"Name":"BER","AMEAN":-0.0076,"GMEAN":-0.0111,"PERFORMANCE":25.3339,"_row":"BER"},{"Name":"BRU","AMEAN":0.0017,"GMEAN":-0.002,"PERFORMANCE":28.2181,"_row":"BRU"},{"Name":"BSE","AMEAN":0.0008,"GMEAN":-0.0053,"PERFORMANCE":25.3867,"_row":"BSE"},{"Name":"BUE","AMEAN":-0.002,"GMEAN":-0.0157,"PERFORMANCE":32.8847,"_row":"BUE"},{"Name":"CPH","AMEAN":-0.0145,"GMEAN":-0.011,"PERFORMANCE":27.0713,"_row":"CPH"},{"Name":"DOH","AMEAN":-0.03,"GMEAN":-0.0327,"PERFORMANCE":26.5088,"_row":"DOH"},{"Name":"DUS","AMEAN":-0.0131,"GMEAN":-0.0023,"PERFORMANCE":23.3281,"_row":"DUS"},{"Name":"EBS","AMEAN":-0.025,"GMEAN":-0.004,"PERFORMANCE":25.3223,"_row":"EBS"},{"Name":"FRA","AMEAN":-0.0077,"GMEAN":-0.0128,"PERFORMANCE":26.0865,"_row":"FRA"},{"Name":"GER","AMEAN":-0.008,"GMEAN":-0.0097,"PERFORMANCE":27.6348,"_row":"GER"},{"Name":"HAM","AMEAN":-0.0123,"GMEAN":-0.0057,"PERFORMANCE":22.9365,"_row":"HAM"},{"Name":"HAN","AMEAN":-0.0113,"GMEAN":-0.0106,"PERFORMANCE":24.9812,"_row":"HAN"},{"Name":"HEL","AMEAN":-0.0009,"GMEAN":-0.0001,"PERFORMANCE":27.6488,"_row":"HEL"},{"Name":"HKG","AMEAN":-0.0147,"GMEAN":-0.0195,"PERFORMANCE":26.7485,"_row":"HKG"},{"Name":"IOB","AMEAN":-0.014,"GMEAN":-0.0209,"PERFORMANCE":30.0979,"_row":"IOB"},{"Name":"IST","AMEAN":0.0111,"GMEAN":0.0072,"PERFORMANCE":32.7744,"_row":"IST"},{"Name":"JKT","AMEAN":0.0044,"GMEAN":-0.0004,"PERFORMANCE":30.6905,"_row":"JKT"},{"Name":"KLS","AMEAN":-0.0011,"GMEAN":-0.0046,"PERFORMANCE":27.8466,"_row":"KLS"},{"Name":"KSC","AMEAN":-0.006,"GMEAN":-0.0044,"PERFORMANCE":24.4577,"_row":"KSC"},{"Name":"LSE","AMEAN":-0.0105,"GMEAN":-0.0181,"PERFORMANCE":26.0632,"_row":"LSE"},{"Name":"MCE","AMEAN":-0.0113,"GMEAN":-0.0181,"PERFORMANCE":27.6074,"_row":"MCE"},{"Name":"MCX","AMEAN":0.0073,"GMEAN":0.012,"PERFORMANCE":24.2185,"_row":"MCX"},{"Name":"MEX","AMEAN":-0.0008,"GMEAN":0.0007,"PERFORMANCE":27.1284,"_row":"MEX"},{"Name":"MIL","AMEAN":-0.0166,"GMEAN":-0.0269,"PERFORMANCE":22.7538,"_row":"MIL"},{"Name":"MUN","AMEAN":-0.0102,"GMEAN":-0.0031,"PERFORMANCE":25.4195,"_row":"MUN"},{"Name":"NCM","AMEAN":-0.0188,"GMEAN":-0.0304,"PERFORMANCE":25.2563,"_row":"NCM"},{"Name":"NGM","AMEAN":-0.0266,"GMEAN":-0.0331,"PERFORMANCE":23.7871,"_row":"NGM"},{"Name":"NMS","AMEAN":-0.0184,"GMEAN":-0.0237,"PERFORMANCE":26.8035,"_row":"NMS"},{"Name":"NSI","AMEAN":0.0059,"GMEAN":-0.0059,"PERFORMANCE":27.7074,"_row":"NSI"},{"Name":"NYQ","AMEAN":-0.0053,"GMEAN":-0.017,"PERFORMANCE":31.4666,"_row":"NYQ"},{"Name":"NZE","AMEAN":0.006,"GMEAN":0.0033,"PERFORMANCE":32.8295,"_row":"NZE"},{"Name":"OBB","AMEAN":-0.0035,"GMEAN":-0.0456,"PERFORMANCE":27.1526,"_row":"OBB"},{"Name":"OSL","AMEAN":-0.0026,"GMEAN":-0.0048,"PERFORMANCE":29.8933,"_row":"OSL"},{"Name":"PAR","AMEAN":-0.0028,"GMEAN":-0.0104,"PERFORMANCE":27.8957,"_row":"PAR"},{"Name":"PCX","AMEAN":-0.0203,"GMEAN":-0.0251,"PERFORMANCE":30.4115,"_row":"PCX"},{"Name":"PNK","AMEAN":-0.0034,"GMEAN":-0.0174,"PERFORMANCE":28.7292,"_row":"PNK"},{"Name":"SAO","AMEAN":-0.0104,"GMEAN":0.002,"PERFORMANCE":25.7092,"_row":"SAO"},{"Name":"SES","AMEAN":0.0007,"GMEAN":-0.0095,"PERFORMANCE":30.0105,"_row":"SES"},{"Name":"SET","AMEAN":0.0024,"GMEAN":0.0012,"PERFORMANCE":28.493,"_row":"SET"},{"Name":"STO","AMEAN":-0.0115,"GMEAN":-0.0064,"PERFORMANCE":25.1477,"_row":"STO"},{"Name":"STU","AMEAN":-0.008,"GMEAN":-0.0058,"PERFORMANCE":27.6223,"_row":"STU"},{"Name":"TAI","AMEAN":-0.0077,"GMEAN":-0.0034,"PERFORMANCE":27.3582,"_row":"TAI"},{"Name":"TLV","AMEAN":-0.0116,"GMEAN":-0.0066,"PERFORMANCE":26.2764,"_row":"TLV"},{"Name":"TOR","AMEAN":-0.0062,"GMEAN":-0.0017,"PERFORMANCE":29.3881,"_row":"TOR"},{"Name":"TWO","AMEAN":-0.0009,"GMEAN":-0.0032,"PERFORMANCE":29.9171,"_row":"TWO"},{"Name":"VAN","AMEAN":0.0056,"GMEAN":0.0119,"PERFORMANCE":35.2548,"_row":"VAN"},{"Name":"VIE","AMEAN":-0.0066,"GMEAN":-0.0227,"PERFORMANCE":25.8583,"_row":"VIE"},{"Name":"VTX","AMEAN":0.0039,"GMEAN":-0.0026,"PERFORMANCE":30.5813,"_row":"VTX"}]
;


var PERIOD= [{"PERIOD":"Period {2015-12-07} : {2016-04-22}"}]
;


    // register our custom symbols to nvd3
    // make sure your path is valid given any size because size scales if the chart scales.
    nv.utils.symbolMap.set('thin-x', function(size) {
        size = Math.sqrt(size);
        return 'M' + (-size/2) + ',' + (-size/2) +'l' + size + ',' + size +'m0,' + -(size) +'l' + (-size) + ',' + size;
    });

    // create the chart
    var chart;
    nv.addGraph(function() {
        chart = nv.models.scatterChart()
            .showDistX(true)
            .showDistY(true)
            .useVoronoi(true)
            .color(d3.scale.category10().range())
            .duration(300)
            .showLegend(false)
        ;

        chart.yAxis
    .axisLabel('Performance');
    chart.xAxis
    .axisLabel('Arth_Mean');
    
       chart.dispatch.on('renderEnd', function(){
           console.log('render complete');
        });

        chart.xAxis.tickFormat(d3.format('.02f'));
        chart.yAxis.tickFormat(d3.format('.02f'));
       chart.tooltipContent(function(key) {
       // return '<h2>' + key + '</h2>';
       return key;
       });

        d3.select('#test1 svg')
            .datum(randomData(datax.length))
            .call(chart);

        nv.utils.windowResize(chart.update);

        chart.dispatch.on('stateChange', function(e) { ('New State:', JSON.stringify(e)); });
        return chart;
    });

    function randomData(points) { //# groups,# points per group
        // smiley and thin-x are our custom symbols!
        var data = [];
        var shapes = ['square'];
        var     random = d3.random.normal();

        for (i = 0; i < points; i++) {
            data.push({ key:'<h2>' +  datax[i].Name + '</h2>' + '<p><small> ' + ' # of Stocks ' + datax[i].STOCKN + ' </small> </p>'+ '<p><small>' + PERIOD[0].PERIOD + ' </small> </p>',values: []});
            data[i].values.push({x: datax[i].AMEAN,y: datax[i].PERFORMANCE,size: Math.round(datax[i].PERFORMANCE )*1000 ,shape: shapes[0 % shapes.length]});
        }

        return data;
    }


</script>
</body>
</html>
