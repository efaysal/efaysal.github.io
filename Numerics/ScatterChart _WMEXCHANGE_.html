<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link href="../build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="../build/nv.d3.js"></script>

    <style>
        text {
            font: 12px sans-serif;
        }
        svg {
            display: block;
        }
        html, body, #test1, svg {
            margin: 0px;
            padding: 0px;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>

<div id="test1" class='with-3d-shadow with-transitions'>
    <svg></svg>
</div>

<script>

var datax= [{"Name":"AMS","AMEAN":-0.0066,"GMEAN":-0.0112,"PERFORMANCE":27.6557,"STOCKN":67,"_row":"AXS"},{"Name":"ASE","AMEAN":-0.0146,"GMEAN":-0.0077,"PERFORMANCE":27.5593,"STOCKN":347,"_row":"V2"},{"Name":"ASX","AMEAN":0.0015,"GMEAN":-0.0025,"PERFORMANCE":27.3937,"STOCKN":986,"_row":"V3"},{"Name":"ATH","AMEAN":-0.0054,"GMEAN":-0.0103,"PERFORMANCE":26.9875,"STOCKN":54,"_row":"V4"},{"Name":"BER","AMEAN":-0.0076,"GMEAN":-0.0111,"PERFORMANCE":25.3339,"STOCKN":379,"_row":"V5"},{"Name":"BRU","AMEAN":0.0017,"GMEAN":-0.002,"PERFORMANCE":28.2181,"STOCKN":70,"_row":"V6"},{"Name":"BSE","AMEAN":0.0008,"GMEAN":-0.0053,"PERFORMANCE":25.3867,"STOCKN":492,"_row":"V7"},{"Name":"BUE","AMEAN":-0.002,"GMEAN":-0.0157,"PERFORMANCE":32.8847,"STOCKN":40,"_row":"V8"},{"Name":"CPH","AMEAN":-0.0145,"GMEAN":-0.011,"PERFORMANCE":27.0713,"STOCKN":83,"_row":"V9"},{"Name":"DOH","AMEAN":-0.03,"GMEAN":-0.0327,"PERFORMANCE":26.5088,"STOCKN":43,"_row":"V10"},{"Name":"DUS","AMEAN":-0.0131,"GMEAN":-0.0023,"PERFORMANCE":23.3281,"STOCKN":116,"_row":"V11"},{"Name":"EBS","AMEAN":-0.025,"GMEAN":-0.004,"PERFORMANCE":25.3223,"STOCKN":163,"_row":"V12"},{"Name":"FRA","AMEAN":-0.0077,"GMEAN":-0.0128,"PERFORMANCE":26.0865,"STOCKN":1361,"_row":"V13"},{"Name":"GER","AMEAN":-0.008,"GMEAN":-0.0097,"PERFORMANCE":27.6348,"STOCKN":496,"_row":"V14"},{"Name":"HAM","AMEAN":-0.0123,"GMEAN":-0.0057,"PERFORMANCE":22.9365,"STOCKN":89,"_row":"V15"},{"Name":"HAN","AMEAN":-0.0113,"GMEAN":-0.0106,"PERFORMANCE":24.9812,"STOCKN":26,"_row":"V16"},{"Name":"HEL","AMEAN":-0.0009,"GMEAN":-0.0001,"PERFORMANCE":27.6488,"STOCKN":61,"_row":"V17"},{"Name":"HKG","AMEAN":-0.0147,"GMEAN":-0.0195,"PERFORMANCE":26.7485,"STOCKN":815,"_row":"V18"},{"Name":"IOB","AMEAN":-0.014,"GMEAN":-0.0209,"PERFORMANCE":30.0979,"STOCKN":28,"_row":"V19"},{"Name":"IST","AMEAN":0.0111,"GMEAN":0.0072,"PERFORMANCE":32.7744,"STOCKN":225,"_row":"V20"},{"Name":"JKT","AMEAN":0.0044,"GMEAN":-0.0004,"PERFORMANCE":30.6905,"STOCKN":223,"_row":"V21"},{"Name":"KLS","AMEAN":-0.0011,"GMEAN":-0.0046,"PERFORMANCE":27.8466,"STOCKN":186,"_row":"V22"},{"Name":"KSC","AMEAN":-0.006,"GMEAN":-0.0044,"PERFORMANCE":24.4577,"STOCKN":294,"_row":"V23"},{"Name":"LSE","AMEAN":-0.0105,"GMEAN":-0.0181,"PERFORMANCE":26.0632,"STOCKN":1269,"_row":"V24"},{"Name":"MCE","AMEAN":-0.0113,"GMEAN":-0.0181,"PERFORMANCE":27.6074,"STOCKN":67,"_row":"V25"},{"Name":"MCX","AMEAN":0.0073,"GMEAN":0.012,"PERFORMANCE":24.2185,"STOCKN":82,"_row":"V26"},{"Name":"MEX","AMEAN":-0.0008,"GMEAN":0.0007,"PERFORMANCE":27.1284,"STOCKN":230,"_row":"V27"},{"Name":"MIL","AMEAN":-0.0166,"GMEAN":-0.0269,"PERFORMANCE":22.7538,"STOCKN":120,"_row":"V28"},{"Name":"MUN","AMEAN":-0.0102,"GMEAN":-0.0031,"PERFORMANCE":25.4195,"STOCKN":363,"_row":"V29"},{"Name":"NCM","AMEAN":-0.0188,"GMEAN":-0.0304,"PERFORMANCE":25.2563,"STOCKN":705,"_row":"V30"},{"Name":"NGM","AMEAN":-0.0266,"GMEAN":-0.0331,"PERFORMANCE":23.7871,"STOCKN":466,"_row":"V31"},{"Name":"NMS","AMEAN":-0.0184,"GMEAN":-0.0237,"PERFORMANCE":26.8035,"STOCKN":1576,"_row":"V32"},{"Name":"NSI","AMEAN":0.0059,"GMEAN":-0.0059,"PERFORMANCE":27.7074,"STOCKN":278,"_row":"V33"},{"Name":"NYQ","AMEAN":-0.0053,"GMEAN":-0.017,"PERFORMANCE":31.4666,"STOCKN":2771,"_row":"V34"},{"Name":"NZE","AMEAN":0.006,"GMEAN":0.0033,"PERFORMANCE":32.8295,"STOCKN":88,"_row":"V35"},{"Name":"OBB","AMEAN":-0.0035,"GMEAN":-0.0456,"PERFORMANCE":27.1526,"STOCKN":300,"_row":"V36"},{"Name":"OSL","AMEAN":-0.0026,"GMEAN":-0.0048,"PERFORMANCE":29.8933,"STOCKN":141,"_row":"V37"},{"Name":"PAR","AMEAN":-0.0028,"GMEAN":-0.0104,"PERFORMANCE":27.8957,"STOCKN":341,"_row":"V38"},{"Name":"PCX","AMEAN":-0.0203,"GMEAN":-0.0251,"PERFORMANCE":30.4115,"STOCKN":21,"_row":"V39"},{"Name":"PNK","AMEAN":-0.0034,"GMEAN":-0.0174,"PERFORMANCE":28.7292,"STOCKN":5130,"_row":"V40"},{"Name":"SAO","AMEAN":-0.0104,"GMEAN":0.002,"PERFORMANCE":25.7092,"STOCKN":190,"_row":"V41"},{"Name":"SES","AMEAN":0.0007,"GMEAN":-0.0095,"PERFORMANCE":30.0105,"STOCKN":310,"_row":"V42"},{"Name":"SET","AMEAN":0.0024,"GMEAN":0.0012,"PERFORMANCE":28.493,"STOCKN":107,"_row":"V43"},{"Name":"STO","AMEAN":-0.0115,"GMEAN":-0.0064,"PERFORMANCE":25.1477,"STOCKN":147,"_row":"V44"},{"Name":"STU","AMEAN":-0.008,"GMEAN":-0.0058,"PERFORMANCE":27.6223,"STOCKN":494,"_row":"V45"},{"Name":"TAI","AMEAN":-0.0077,"GMEAN":-0.0034,"PERFORMANCE":27.3582,"STOCKN":248,"_row":"V46"},{"Name":"TLV","AMEAN":-0.0116,"GMEAN":-0.0066,"PERFORMANCE":26.2764,"STOCKN":80,"_row":"V47"},{"Name":"TOR","AMEAN":-0.0062,"GMEAN":-0.0017,"PERFORMANCE":29.3881,"STOCKN":892,"_row":"V48"},{"Name":"TWO","AMEAN":-0.0009,"GMEAN":-0.0032,"PERFORMANCE":29.9171,"STOCKN":148,"_row":"V49"},{"Name":"VAN","AMEAN":0.0056,"GMEAN":0.0119,"PERFORMANCE":35.2548,"STOCKN":841,"_row":"V50"},{"Name":"VIE","AMEAN":-0.0066,"GMEAN":-0.0227,"PERFORMANCE":25.8583,"STOCKN":31,"_row":"V51"},{"Name":"VTX","AMEAN":0.0039,"GMEAN":-0.0026,"PERFORMANCE":30.5813,"STOCKN":17,"_row":"V52"}]
;


var PERIOD= [{"PERIOD":"Period {2015-12-07} : {2016-04-22}"}]
;


    // register our custom symbols to nvd3
    // make sure your path is valid given any size because size scales if the chart scales.
    nv.utils.symbolMap.set('thin-x', function(size) {
        size = Math.sqrt(size);
        return 'M' + (-size/2) + ',' + (-size/2) +'l' + size + ',' + size +'m0,' + -(size) +'l' + (-size) + ',' + size;
    });

    // create the chart
    var chart;
    nv.addGraph(function() {
        chart = nv.models.scatterChart()
            .showDistX(true)
            .showDistY(true)
            .useVoronoi(true)
            .color(d3.scale.category10().range())
            .duration(300)
            .showLegend(false)
        ;

        chart.yAxis
    .axisLabel('Performance');
    chart.xAxis
    .axisLabel('Arth_Mean');
    
       chart.dispatch.on('renderEnd', function(){
           console.log('render complete');
        });

        chart.xAxis.tickFormat(d3.format('.02f'));
        chart.yAxis.tickFormat(d3.format('.02f'));
       chart.tooltipContent(function(key) {
       // return '<h2>' + key + '</h2>';
       return key;
       });

        d3.select('#test1 svg')
            .datum(randomData(datax.length))
            .call(chart);

        nv.utils.windowResize(chart.update);

        chart.dispatch.on('stateChange', function(e) { ('New State:', JSON.stringify(e)); });
        return chart;
    });

    function randomData(points) { //# groups,# points per group
        // smiley and thin-x are our custom symbols!
        var data = [];
        var shapes = ['square'];
        var     random = d3.random.normal();

        for (i = 0; i < points; i++) {
            data.push({ key:'<h2>' +  datax[i].Name + '</h2>' + '<p><small> ' + ' # of Stocks ' + datax[i].STOCKN + ' </small> </p>'+ '<p><small>' + PERIOD[0].PERIOD + ' </small> </p>',values: []});
            data[i].values.push({x: datax[i].AMEAN,y: datax[i].PERFORMANCE,size: Math.round(datax[i].PERFORMANCE )*1000 ,shape: shapes[0 % shapes.length]});
        }

        return data;
    }


</script>
</body>
</html>
